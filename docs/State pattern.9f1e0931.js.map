{"version":3,"sources":["models/playerStates.ts","models/player.ts","index.ts"],"names":[],"mappings":"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","file":"State pattern.9f1e0931.js","sourceRoot":"..","sourcesContent":["import { Player } from './player';\r\n\r\nexport interface IPlayerState {\r\n\tenter(): void;\r\n\tleave(): void;\r\n\tplay(): void;\r\n\tstop(): void;\r\n\tpause(): void;\r\n\trewind(): void;\r\n}\r\n\r\nexport abstract class PlayerState implements IPlayerState {\r\n\tconstructor(\r\n\t\tprivate readonly _playerRef: Player,\r\n\t\tprivate readonly _name?: string\r\n\t) {}\r\n\r\n\tplay(): void {\r\n\t\tthis._playerRef.changeState(this._playerRef.states.get('playing'));\r\n\t}\r\n\r\n\tstop(): void {\r\n\t\tthis._playerRef.changeState(this._playerRef.states.get('stopped'));\r\n\t}\r\n\r\n\tpause(): void {\r\n\t\tthis._playerRef.changeState(this._playerRef.states.get('paused'));\r\n\t}\r\n\r\n\trewind(): void {\r\n\t\tthis._playerRef.changeState(this._playerRef.states.get('rewinding'));\r\n\t}\r\n\r\n\tenter(): void {}\r\n\r\n\tleave(): void {}\r\n\r\n\tget playerRef(): Player {\r\n\t\treturn this._playerRef;\r\n\t}\r\n\r\n\tget name(): string {\r\n\t\treturn this._name || '';\r\n\t}\r\n}\r\n\r\nexport class PlayingState extends PlayerState implements IPlayerState {\r\n\tenter(): void {\r\n\t\tthis.playerRef.videoEl.play();\r\n\t}\r\n}\r\n\r\nexport class StoppedState extends PlayerState implements IPlayerState {\r\n\tenter(): void {\r\n\t\tthis.playerRef.videoEl.pause();\r\n\t\tthis.playerRef.videoEl.currentTime = 0;\r\n\t}\r\n}\r\n\r\nexport class PausedState extends PlayerState implements IPlayerState {\r\n\tenter(): void {\r\n\t\tthis.playerRef.videoEl.pause();\r\n\t}\r\n}\r\n\r\nexport class RewindingState extends PlayerState implements IPlayerState {\r\n\tenter() {\r\n\t\tthis.playerRef.videoEl.pause();\r\n\t\tthis.playerRef.progressEl.addEventListener('input', this.progressHandler);\r\n\t}\r\n\r\n\tleave() {\r\n\t\tthis.playerRef.progressEl.removeEventListener(\r\n\t\t\t'input',\r\n\t\t\tthis.progressHandler\r\n\t\t);\r\n\t}\r\n\r\n\tprivate progressHandler = ($event: InputEvent) => {\r\n\t\tconst target = $event.target as HTMLInputElement;\r\n\t\tthis.playerRef.videoEl.currentTime = parseFloat(target.value);\r\n\t};\r\n}\r\n","import {\r\n\tPlayerState,\r\n\tPlayingState,\r\n\tStoppedState,\r\n\tPausedState,\r\n\tRewindingState,\r\n} from './playerStates';\r\n\r\nexport class Player {\r\n\tconstructor(container: HTMLElement | string) {\r\n\t\tthis.setupElements(container);\r\n\t\tthis.setupEventsListeners();\r\n\t\tthis.setupStates();\r\n\t}\r\n\tprivate state: PlayerState;\r\n\tprivate readonly _elements: Map<string, HTMLElement> = new Map();\r\n\tprivate readonly _states: Map<string, PlayerState> = new Map();\r\n\r\n\tplay() {\r\n\t\tthis.state.play();\r\n\t}\r\n\r\n\tstop() {\r\n\t\tthis.state.stop();\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.state.pause();\r\n\t}\r\n\r\n\trewind() {\r\n\t\tthis.state.rewind();\r\n\t}\r\n\r\n\tchangeState(newState: PlayerState): void {\r\n\t\tif (this.state === newState) return;\r\n\r\n\t\tthis.state.leave();\r\n\t\tthis.state = newState;\r\n\t\tthis.state.enter();\r\n\t}\r\n\r\n\tprivate setupStates(): void {\r\n\t\tthis._states.set('playing', new PlayingState(this, 'playing'));\r\n\t\tthis._states.set('stopped', new StoppedState(this, 'stopped'));\r\n\t\tthis._states.set('paused', new PausedState(this, 'paused'));\r\n\t\tthis._states.set('rewinding', new RewindingState(this, 'rewinding'));\r\n\r\n\t\tthis.state = this._states.get('stopped');\r\n\t}\r\n\r\n\tprivate setupEventsListeners(): void {\r\n\t\tthis.videoEl.addEventListener(\r\n\t\t\t'timeupdate',\r\n\t\t\tthis.updateVideoProgress.bind(this)\r\n\t\t);\r\n\r\n\t\tthis._elements.get('play').addEventListener('click', this.play.bind(this));\r\n\r\n\t\tthis._elements\r\n\t\t\t.get('pause')\r\n\t\t\t.addEventListener('click', this.pause.bind(this));\r\n\r\n\t\tthis._elements.get('stop').addEventListener('click', this.stop.bind(this));\r\n\r\n\t\tthis._elements\r\n\t\t\t.get('progress')\r\n\t\t\t.addEventListener('mousedown', this.rewind.bind(this));\r\n\r\n\t\tthis._elements\r\n\t\t\t.get('progress')\r\n\t\t\t.addEventListener('mouseup', this.play.bind(this));\r\n\t}\r\n\r\n\tprivate setupElements(container: HTMLElement | string): void {\r\n\t\tif (typeof container === 'string')\r\n\t\t\tthis._elements.set('host', document.querySelector(container as string));\r\n\t\telse this._elements.set('host', container as HTMLElement);\r\n\r\n\t\tconst hostEl = this._elements.get('host');\r\n\r\n\t\tthis._elements.set('video', hostEl.querySelector('.player__video'));\r\n\t\tthis._elements.set('progress', hostEl.querySelector('.player__progress'));\r\n\t\tthis._elements.set('stop', hostEl.querySelector('.player__stop'));\r\n\t\tthis._elements.set('play', hostEl.querySelector('.player__play'));\r\n\t\tthis._elements.set('pause', hostEl.querySelector('.player__pause'));\r\n\t}\r\n\r\n\tprivate updateVideoProgress(): void {\r\n\t\tconst videoEl = this._elements.get('video') as HTMLVideoElement;\r\n\t\tconst progressEl = this._elements.get('progress') as HTMLProgressElement;\r\n\t\tconst { currentTime, duration } = videoEl;\r\n\r\n\t\tprogressEl.setAttribute('max', duration.toString());\r\n\t\tprogressEl.value = currentTime;\r\n\t}\r\n\r\n\tget videoEl(): HTMLVideoElement {\r\n\t\treturn this._elements.get('video') as HTMLVideoElement;\r\n\t}\r\n\r\n\tget states(): Map<string, PlayerState> {\r\n\t\treturn this._states;\r\n\t}\r\n\r\n\tget progressEl(): HTMLInputElement {\r\n\t\treturn this._elements.get('progress') as HTMLInputElement;\r\n\t}\r\n}\r\n","import { Player } from './models/player';\r\n\r\nconst videoPlayer = new Player('.player');\r\n"]}